# Introduction
This model includes a seriaes of state-of-art knowledge graph algorithms.
TransE: [Paper](https://papers.nips.cc/paper/5071-translating-embeddings-for-modeling-multi-relational-data)
DistMult: [Paper](https://arxiv.org/abs/1412.6575)
ComplEx: [Paper](https://arxiv.org/abs/1606.0635)
RotatE [Paper](https://arxiv.org/abs/1902.10197)

# Generate Graph Data
pytorch/data/tools/convert_kg_to_json.py: convert standard knowledge graph data to deepgnn json format.
pytorch/data/tools/produce_test_file.py: generate sample file for evaluation.
* [Prepare Graph Data](../../../docs/graph_engine/data_spec.rst)

# Job Augmentations
## GAT
Training
> --mode train --model kgemodel --num_epochs 3 --batch_size 1024 --dim=1000 --max_id=56944 --learning_rate=0.001 --num_negs=256 --cuda=1 --model_args={\"double_entity_embedding\":1, \"adversarial_temperature\":1.0, \"regularization\":0.0, \"gamma\":24.0, \"metadata_path\":\"deepgnn/core/pytorch/testdata/rotatE/FB15k/metadata.ini\", \"score_func\":\"RotatE\"}

### Evaluate
> --mode evaluate --model gat --batch_size 1024 --dim=1000 --max_id=56944 --learning_rate=0.001 --num_negs=256 --cuda=1 --model_args={\"double_entity_embedding\":1, \"adversarial_temperature\":1.0, \"regularization\":0.0, \"gamma\":24.0, \"metadata_path\":\"deepgnn/core/pytorch/testdata/rotatE/FB15k/metadata.ini\", \"score_func\":\"RotatE\"} --sample_file /path/to/test_edge_file

> __Note:__ sample file include triplet for testing which can be generated by  tools\graph_builder\produce_test_file.py

### Inference
> --mode inference --model gat --batch_size 1024 -dim=1000 --max_id=56944 --learning_rate=0.001 --num_negs=256 --cuda=1 --model_args={\"double_entity_embedding\":1, \"adversarial_temperature\":1.0, \"regularization\":0.0, \"gamma\":24.0, \"metadata_path\":\"deepgnn/core/pytorch/testdata/rotatE/FB15k/metadata.ini\", \"score_func\":\"RotatE\"} --sample_file /path/to/node

# Parameters

Code reference:

| Parameters | Default | Description |
| ----- | ----------- | ------- |
| **mode** | train | Run mode. ["train", "evaluate", "save_embedding", "inference"] |
| **num_epochs** | 20 | Number of epochs for training. |
| **batch_size** | 512 | Mini-batch size. |
| **learning_rate** | 0.01 | Learning rate. |
| **optimizer** | adam | TF Optimizer. ["adagrad", "adam", "adadelta", "rmsprop", "ftrl", "sgd", "momentum"] |
| **max_id** | -1 | Max node id. |
| **dim** | None | Entity embeding dimension. |
| **num_negs** | 5| Number of negative samples. |
| **model_args** | "" | Json string which include all necessary parameters for KGE model. |


| Model Args | Default | Description |
| ----- | ----------- | ------- |
| **double_entity_embedding** | false | Whether to double the entity embeding size for training |
| **double_relation_embedding** | false | Whether to double the relation embeding size for training |
| **adversarial_temperature** | 0.0 | adversarial temerature used by adversarial sampling, if =0.0, the feature is disalbed.|
| **regularization** | 0.0 | regularization.|
| **gamma** | 0.0 | gamma value for score function.|
| **score_func** | None | score function: RotatE, ComplEx, DistMult, TransE.|
| **metadata_path** | None | the file path which contain all necessary metadata setting, like entity number and relation number.|
